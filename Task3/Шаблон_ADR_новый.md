### <a name="_b7urdng99y53">**Название задачи: MVP цифровизации открытия депозитов через сайт и интернет-банк** </a>
### <a name="_hjk0fkfyohdk">**Автор: Команда цифровой трансформации банка «Стандарт»**</a>
### <a name="_uanumrh8zrui">**Дата: 2025-06-25**</a>

### <a name="_3bfxc9a45514">**Функциональные требования**</a>

| №  | Действующие лица или системы         | Use Case                                      | Описание                                                                  |
|----|--------------------------------------|-----------------------------------------------|---------------------------------------------------------------------------|
| 1  | Новый клиент                         | Подача заявки на депозит через сайт           | Вводит ФИО и номер телефона, отправляет заявку, далее ему звонит оператор |
| 2  | Менеджер кол-центра                  | Обработка заявки с сайта                      | Звонит клиенту, предлагает условия, отправляет в отделение                |
| 3  | Зарегистрированный клиент            | Открытие депозита в интернет-банке            | Выбирает продукт, указывает сумму и счёт, подтверждает СМС                |
| 4  | Система интернет-банка               | Отправка заявки на открытие депозита          | Создаёт запись в промежуточном сервисе/БД, уведомляет клиента             |
| 5  | Менеджер бэк-офиса                   | Подтверждение и создание депозита в АБС       | Получает заявку, подтверждает ставку и создаёт депозит вручную            |
| 6  | Система                              | Отправка СМС                                  | Отправляет СМС с подтверждением и результатами клиенту                    |

---
### <a name="_u8xz25hbrgql">**Нефункциональные требования**</a>

| №  | Требование                                                                 |
|----|----------------------------------------------------------------------------|
| 1  | Высокая доступность: 99.9% доступности, 24/7 работа                        |
| 2  | Разделение нагрузки — исключить прямой доступ интернет-банка к АБС        |
| 3  | Безопасность данных: HTTPS, защита ПД, шифрование                         |
| 4  | Горизонтальное масштабирование сервисов, кэширование справочников        |
| 5  | Использование существующих технологий: MS SQL, Oracle, .NET, Java         |
| 6  | Работа с СМС без изменений в ядре интернет-банка                          |
| 7  | Время отклика интерфейса — не более 1 секунды                             |
| 8  | Возможность расширения архитектуры до микросервисной                      |
| 9  | Поддержка резервного ЦОД и автоматическое переключение                    |
| 10 | Документирование всех компонентов и API                                   |

---

### <a name="_qmphm5d6rvi3">**Решение**</a>

#### Контекст (C4: Context)
Система обработки депозитов взаимодействует с:
- Клиентами (через сайт и интернет-банк)
- Кол-центром (через систему кол-центра)
- Бэк-офисом (через интерфейс и АБС)
- СМС-шлюзом (для отправки уведомлений)
- АБС (через промежуточный сервис)

**Диаграмма контекста:**
См. файл `ContextDiagram.png`

---

#### Контейнеры (C4: Container)
Основные контейнеры:
- **Сайт**: принимает заявки, отправляет в сервис заявок.
- **Интернет-банк**: взаимодействует с клиентом, формирует заявку с персонализированной ставкой.
- **Сервис заявок**: принимает заявки, хранит, отправляет в АБС, шлёт события и триггеры СМС.
- **Сервис ставок**: отдельный компонент/БД, хранилище ставок, доступное бэк-офисам.
- **АБС**: только вручную обрабатывает заявки и создает депозит (в MVP).
- **СМС-шлюз**: оповещения клиентам.
- **Система кол-центра**: принимает заявки с сайта, формирует задачи операторам.

**Диаграмма контейнеров:**
См. файл `ContainerDiagram.png`

---

**Принципы архитектурного решения:**
- Интернет-банк и сайт работают с собственной API-шиной (на .NET/Java).
- Прямая интеграция с АБС исключена — во избежание перегрузки и рисков.
- Все операции логируются и хранятся в MS SQL (совместимо с интернет-банком).
- Ставки извлекаются из новой БД ставок с возможностью расширения.
- Используется шина/очередь событий (если потребуется Kafka — буферизация через адаптер).
- Все сервисы масштабируются горизонтально и могут быть задеплоены в два ЦОД.

---

### <a name="_bjrr7veeh80c">**Альтернативы**</a>
1. **Прямая интеграция интернет-банка с АБС**
   - ❌ Недопустимо по требованиям отказоустойчивости и производительности.
2. **Модификация ядра интернет-банка подрядчика**
   - ❌ Дорого, долго, требует внешней команды, нарушает SLA.
3. **Использование Kafka напрямую**
   - ⚠️ Потенциально полезно в будущем, но сейчас интернет-банк не поддерживает.

---

### Недостатки, ограничения, риски

- ❗ Бэк-офисное подтверждение вручную — узкое место MVP.
- ❗ Excel по ставкам — технический долг, необходимо заменить на API-сервис.
- ⚠️ Один ЦОД, автоматическое переключение ещё не реализовано.
- ⚠️ Без автоматизации обработки заявок возможна задержка откликов клиенту.
- ⚠️ Без единой витрины ставок возможны расхождения между сайтом и интернет-банком.
- ⚠️ Пока нет масштабирования/разделения кол-центра и CRM.

